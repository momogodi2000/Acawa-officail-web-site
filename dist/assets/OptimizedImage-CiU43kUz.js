import{j as s}from"./query-BNDeIO0n.js";import{r as l}from"./vendor-DtOhX2xw.js";const D={small:320,medium:640,large:1024,xlarge:1920},W=(t,e=D)=>{const r=t.replace(/\.[^/.]+$/,""),a=t.split(".").pop()||"jpg";return{webp:{small:`${r}-${e.small}w.webp`,medium:`${r}-${e.medium}w.webp`,large:`${r}-${e.large}w.webp`,xlarge:`${r}-${e.xlarge}w.webp`},fallback:{small:`${r}-${e.small}w.${a}`,medium:`${r}-${e.medium}w.${a}`,large:`${r}-${e.large}w.${a}`,xlarge:`${r}-${e.xlarge}w.${a}`},original:t}},u=t=>Object.entries(t).map(([e,r])=>`${r} ${e==="small"?320:e==="medium"?640:e==="large"?1024:1920}w`).join(", "),b=()=>"(max-width: 320px) 320px, (max-width: 640px) 640px, (max-width: 1024px) 1024px, 1920px",P=()=>new Promise(t=>{const e=new Image;e.onload=e.onerror=()=>{t(e.height===2)},e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"});var o=(t=>(t.LOADING="loading",t.LOADED="loaded",t.ERROR="error",t))(o||{});const V=({src:t,alt:e,lazy:r=!0,responsive:a=!0,imageSizes:h,quality:C="gallery",placeholder:m,showLoadingSpinner:A=!0,onLoad:$,onError:j,className:R="",fallbackSrc:w,...d})=>{const[c,f]=l.useState(o.LOADING),[v,I]=l.useState(!1),[i,y]=l.useState(!r),S=l.useRef(null),g=l.useRef(null);l.useEffect(()=>{P().then(I)},[]),l.useEffect(()=>{if(!r||i)return;const p=new IntersectionObserver(([k])=>{k.isIntersecting&&(y(!0),p.disconnect())},{threshold:.1,rootMargin:"50px"});return g.current&&p.observe(g.current),()=>p.disconnect()},[r,i]);const O=()=>{f(o.LOADED),$?.()},E=()=>{f(o.ERROR),j?.()},n=a?W(t,h):null,x=v&&n,L=x?u(n.webp):n?u(n.fallback):void 0,N=i?c===o.ERROR&&w?w:t:m||"";return s.jsxs("div",{ref:g,className:`relative overflow-hidden ${R}`,...d.style&&{style:d.style},children:[!i&&m&&s.jsx("img",{src:m,alt:"",className:"absolute inset-0 w-full h-full object-cover filter blur-sm","aria-hidden":"true"}),i&&c===o.LOADING&&A&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-200 animate-pulse",children:s.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})}),c===o.ERROR&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-200",children:s.jsxs("div",{className:"text-center p-4",children:[s.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),s.jsx("p",{className:"text-sm text-gray-500",children:"Image failed to load"})]})}),i&&s.jsxs("picture",{children:[x&&n&&s.jsx("source",{srcSet:u(n.webp),sizes:a?b():void 0,type:"image/webp"}),a&&n&&!x&&s.jsx("source",{srcSet:u(n.fallback),sizes:b()}),s.jsx("img",{ref:S,src:N,alt:e,srcSet:L,sizes:a?b():void 0,onLoad:O,onError:E,loading:r?"lazy":"eager",decoding:"async",className:`w-full h-full object-cover transition-opacity duration-300 ${c===o.LOADED?"opacity-100":"opacity-0"}`,...d})]})]})};export{V as O};
