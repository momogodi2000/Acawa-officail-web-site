import{j as e}from"./query-DN-OeCz4.js";import{r as a}from"./vendor-CYcvts7D.js";const r={small:320,medium:640,large:1024,xlarge:1920},s=e=>Object.entries(e).map(([e,a])=>`${a} ${"small"===e?320:"medium"===e?640:"large"===e?1024:1920}w`).join(", ");var t=(e=>(e.LOADING="loading",e.LOADED="loaded",e.ERROR="error",e))(t||{});const l=({src:l,alt:i,lazy:o=!0,responsive:n=!0,imageSizes:c,quality:d="gallery",placeholder:m,showLoadingSpinner:x=!0,onLoad:p,onError:u,className:g="",fallbackSrc:w,...h})=>{const[b,f]=a.useState(t.LOADING),[j,A]=a.useState(!1),[$,v]=a.useState(!o),y=a.useRef(null),R=a.useRef(null);a.useEffect(()=>{new Promise(e=>{const a=new Image;a.onload=a.onerror=()=>{e(2===a.height)},a.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}).then(A)},[]),a.useEffect(()=>{if(!o||$)return;const e=new IntersectionObserver(([a])=>{a.isIntersecting&&(v(!0),e.disconnect())},{threshold:.1,rootMargin:"50px"});return R.current&&e.observe(R.current),()=>e.disconnect()},[o,$]);const L=n?((e,a=r)=>{const s=e.replace(/\.[^/.]+$/,""),t=e.split(".").pop()||"jpg";return{webp:{small:`${s}-${a.small}w.webp`,medium:`${s}-${a.medium}w.webp`,large:`${s}-${a.large}w.webp`,xlarge:`${s}-${a.xlarge}w.webp`},fallback:{small:`${s}-${a.small}w.${t}`,medium:`${s}-${a.medium}w.${t}`,large:`${s}-${a.large}w.${t}`,xlarge:`${s}-${a.xlarge}w.${t}`},original:e}})(l,c):null,N=j&&L,O=N?s(L.webp):L?s(L.fallback):void 0,I=$?b===t.ERROR&&w?w:l:m||"";return e.jsxs("div",{ref:R,className:`relative overflow-hidden ${g}`,...h.style&&{style:h.style},children:[!$&&m&&e.jsx("img",{src:m,alt:"",className:"absolute inset-0 w-full h-full object-cover filter blur-sm","aria-hidden":"true"}),$&&b===t.LOADING&&x&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-200 animate-pulse",children:e.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})}),b===t.ERROR&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-200",children:e.jsxs("div",{className:"text-center p-4",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Image failed to load"})]})}),$&&e.jsxs("picture",{children:[N&&L&&e.jsx("source",{srcSet:s(L.webp),sizes:n?"(max-width: 320px) 320px, (max-width: 640px) 640px, (max-width: 1024px) 1024px, 1920px":void 0,type:"image/webp"}),n&&L&&!N&&e.jsx("source",{srcSet:s(L.fallback),sizes:"(max-width: 320px) 320px, (max-width: 640px) 640px, (max-width: 1024px) 1024px, 1920px"}),e.jsx("img",{ref:y,src:I,alt:i,srcSet:O,sizes:n?"(max-width: 320px) 320px, (max-width: 640px) 640px, (max-width: 1024px) 1024px, 1920px":void 0,onLoad:()=>{f(t.LOADED),p?.()},onError:()=>{f(t.ERROR),u?.()},loading:o?"lazy":"eager",decoding:"async",className:"w-full h-full object-cover transition-opacity duration-300 "+(b===t.LOADED?"opacity-100":"opacity-0"),...h})]})]})};export{l as O};
