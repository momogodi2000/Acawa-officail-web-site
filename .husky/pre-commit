#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo '🚀 Running pre-commit hooks for ACAWA Platform...'

# Check TypeScript types
echo '🔍 Type checking TypeScript...'
npx tsc --noEmit
if [ $? -ne 0 ]; then
  echo '❌ TypeScript type check failed. Please fix the errors before committing.'
  exit 1
fi

# Run ESLint
echo '📝 Linting code...'
npx eslint . --ext .ts,.tsx --max-warnings 0
if [ $? -ne 0 ]; then
  echo '❌ ESLint check failed. Please fix the linting errors before committing.'
  exit 1
fi

# Run Prettier
echo '💄 Checking code formatting...'
npx prettier --check "src/**/*.{ts,tsx,js,jsx,json,css,md}"
if [ $? -ne 0 ]; then
  echo '❌ Code formatting check failed. Please run "npm run format" before committing.'
  exit 1
fi

# Run tests
echo '🧪 Running tests...'
npm run test
if [ $? -ne 0 ]; then
  echo '❌ Tests failed. Please fix the failing tests before committing.'
  exit 1
fi

echo '✅ All pre-commit hooks passed! Ready to commit.'
