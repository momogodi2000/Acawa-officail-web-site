#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo 'ğŸš€ Running pre-commit hooks for ACAWA Platform...'

# Check TypeScript types
echo 'ğŸ” Type checking TypeScript...'
npx tsc --noEmit
if [ $? -ne 0 ]; then
  echo 'âŒ TypeScript type check failed. Please fix the errors before committing.'
  exit 1
fi

# Run ESLint
echo 'ğŸ“ Linting code...'
npx eslint . --ext .ts,.tsx --max-warnings 0
if [ $? -ne 0 ]; then
  echo 'âŒ ESLint check failed. Please fix the linting errors before committing.'
  exit 1
fi

# Run Prettier
echo 'ğŸ’„ Checking code formatting...'
npx prettier --check "src/**/*.{ts,tsx,js,jsx,json,css,md}"
if [ $? -ne 0 ]; then
  echo 'âŒ Code formatting check failed. Please run "npm run format" before committing.'
  exit 1
fi

# Run tests
echo 'ğŸ§ª Running tests...'
npm run test
if [ $? -ne 0 ]; then
  echo 'âŒ Tests failed. Please fix the failing tests before committing.'
  exit 1
fi

echo 'âœ… All pre-commit hooks passed! Ready to commit.'
